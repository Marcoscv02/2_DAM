# 1. Introducci√≥n
[[1. Windows Processes]]
La clase `Runtime` es una clase **singleton** presente en todas las aplicaciones de Java cuyo objetivo es permitirnos interactuar con el entorno donde esta se est√° ejecutando. La clase `Runtime` proporciona m√©todos para ejecutar procesos, invocar el recolector de basura (GC), obtener la memoria total y libre, entre otros.

Se puede acceder a ella mediante el m√©todo `Runtime.getRuntime()`.

### M√©todos importantes de la clase Java Runtime

| M√©todo                                                                                  | Descripci√≥n                                                                         |
| --------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| <span style="color:rgb(255, 0, 0)"><b>public static Runtime getRuntime()<b></span>      | Devuelve la instancia de la clase `Runtime`.                                        |
| <span style="color:rgb(255, 0, 0)"><b>public void exit(int status)</b></span>           | Termina la m√°quina virtual Java (JVM) actual.                                       |
| <span style="color:rgb(255, 0, 0)"><b>public Process exec(String[] cmdarray)</b></span> | Ejecuta un comando o proceso en un proceso separado y devuelve un objeto `Process`. |
| <span style="color:rgb(255, 0, 0)"><b>public long freeMemory()</b></span>               | Devuelve la cantidad de memoria libre en la JVM.                                    |
| <span style="color:rgb(255, 0, 0)"><b>public long totalMemory()</b></span>              | Devuelve la cantidad total de memoria en la JVM.                                    |
| <span style="color:rgb(255, 0, 0)"><b>public long maxMemory()</b></span>                | Devuelve la cantidad m√°xima de memoria que intentar√° usar la JVM.                   |
| <span style="color:rgb(255, 0, 0)"><b>public void gc()</b></span>                       | Ejecuta el recolector de basura.                                                    |
| <span style="color:rgb(255, 0, 0)"><b>public int availableProcessors()</b></span>       | Devuelve el n√∫mero de procesadores disponibles para la JVM.                         |

# 2. M√©todo `Runtime.exec()`

El m√©todo `Runtime.exec()` permite ejecutar comandos externos desde una aplicaci√≥n Java, creando un proceso nativo representado por un objeto `Process`. Con este objeto, se puede gestionar la salida, entrada y errores del subproceso.

<aside  style="border: 2px solid purple; padding: 10px; border-radius: 5px;"> üó®Ô∏è
Para que la aplicaci√≥n Java espere la finalizaci√≥n del proceso, se usa el m√©todo `waitFor()`.
</aside>

### Ejemplo: Ejecutar Notepad++

El siguiente c√≥digo ejecuta Notepad++ desde una aplicaci√≥n Java:

```java
package org.example;

import java.io.IOException;

public class NotepadPlusPlus {
    public static void main(String[] args) throws IOException {
        Runtime runtime = Runtime.getRuntime();
        String[] command = {"C:/Program Files/Notepad++/Notepad++.exe"};
        Process process = runtime.exec(command);
    }
}
```

### Abrir un archivo con Notepad++

Este c√≥digo abre un archivo `info.txt` ubicado en la carpeta de recursos del proyecto con Notepad++:

```java
package org.example;

import java.io.IOException;

public class NotepadPlusPlusFile {
    public static void main(String[] args) throws IOException {
        Runtime runtime = Runtime.getRuntime();
        String[] command = {"C:/Program Files/Notepad++/Notepad++.exe", "./src/main/resources/info.txt"};
        Process process = runtime.exec(command);
    }
}
```

# 3. Capturar la salida est√°ndar

Cuando se ejecuta un proceso que genera una salida, se puede capturar esa salida utilizando un `BufferedReader` o un `Scanner` para leer l√≠nea por l√≠nea:

### Ejemplo usando `BufferedReader`:

```java
BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
String line;
while ((line = reader.readLine()) != null) {
    System.out.println(line);
}
reader.close();
```

### Ejemplo usando `Scanner`:

```java
Scanner scanner = new Scanner(process.getInputStream());
while (scanner.hasNextLine()) {
    System.out.println(scanner.nextLine());
}
scanner.close();
```

### Ejecutar el comando `date`:

Este c√≥digo ejecuta el comando `date /t` para mostrar la fecha actual:

```java
package org.example;

import java.io.IOException;
import java.util.Scanner;

public class CommandDate {
    public static void main(String[] args) throws IOException {
        String[] command = {"cmd", "/c", "date", "/T"};
        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(command);
        Scanner scanner = new Scanner(process.getInputStream());
        while (scanner.hasNextLine()) {
            System.out.println(scanner.nextLine());
        }
        scanner.close();
    }
}

```

# 4. Capturar salida de error

<aside style="border: 2px solid yellow; padding: 10px; border-radius: 5px;"> üí°
No todos los comandos se ejecutan correctamente, por lo que <b>es importante capturar los mensajes de error</b> que se env√≠an al flujo de errores est√°ndar:
</aside>

```java
int exitCode = process.waitFor();
if (exitCode != 0) {
    Scanner errorScanner = new Scanner(process.getErrorStream());
    while (errorScanner.hasNextLine()) {
        System.out.println(errorScanner.nextLine());
    }
    errorScanner.close();
}
```

# 5. Enviar entrada a un proceso

<aside style="border: 2px solid yellow; padding: 10px; border-radius: 5px;"> üí°
Algunos procesos interactivos requieren entradas. Podemos enviar entradas utilizando el <span style="color:rgb(255, 0, 0)"><b>`OutputStream`</b></span> del objeto <span style="color:rgb(255, 0, 0)"><b>`Process`</b></span>. En este ejemplo, se intenta cambiar la fecha del sistema:
</aside>

```java
package org.example;

import java.io.BufferedWriter;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.util.Scanner;

public class CommandDateInt {
    public static void main(String[] args) throws IOException, InterruptedException {
        String[] command = {"cmd", "/C", "date"};
        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(command);
        BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()));
        writer.write("24-09-24");
        writer.close();

        Scanner scanner = new Scanner(process.getInputStream());
        while (scanner.hasNextLine()) {
            System.out.println(scanner.nextLine());
        }
        scanner.close();
    }
}
```

# 6. Esperar la finalizaci√≥n del proceso

Para esperar a que un proceso termine, se puede utilizar el m√©todo `waitFor()`:

```java
int exitCode = process.waitFor();
if (exitCode != 0) {
    System.out.println("Terminaci√≥n anormal del proceso");
}
```