[[4. GSON Creaci√≥n de instancias Gson]]
# 1. De Java a JSON**: `toJson()`**

Gson puede generar un archivo JSON a partir de objetos Java mediante el m√©todo `toJson()` de la clase `Gson`.

- **Ejemplo b√°sico:**

```java
Poeta poeta = new Poeta();
poeta.setNome("Sylvia Plath");
poeta.setIdade(30);

Gson gson = new Gson();
String json = gson.toJson(poeta);
```

- **Salida con formato estandar:**

```json
{"nome":"Sylvia Plath","idade":30}
```

- **Impresi√≥n con formato "bonito"**: `setPrettyPrinting()`


 >üí°Gson genera por defecto una salida JSON compacta, pero puedes hacerla m√°s legible con `setPrettyPrinting()` de `GsonBuilder`:


```java
Gson gson = new GsonBuilder()
								.setPrettyPrinting()
								.create();
String json = gson.toJson(poeta);
```

- **Salida con formato** `setPrettyPrinting()` ****:

```json
{
  "nome": "Sylvia Plath",
  "idade": 30
}
```

---

# 2. **De JSON a Java: `fromJson()`**

Gson tambi√©n puede convertir JSON en objetos Java usando el m√©todo `fromJson()`.

- **Ejemplo b√°sico:**

```java
String textoJson = "{\\"nome\\":\\"Sylvia Plath\\", \\"idade\\": 30}"; //Cadena Jsona a analizar
Gson gson = new Gson();
Poeta poeta = gson.fromJson(textoJson, Poeta.class);// Debemos indicar el tipo de objeto a crear
```

> El **primer par√°metro** de `fromJson()` es la fuente JSON (`String`, `Reader`, `JsonReader` o `JsonElement`).

> El **segundo par√°metro** del m√©todo `fromJson()` es la clase de Java para analizar el JSON en una instancia.



>‚ùó En el ejemplo anterior, la fuente JSON es una cadena, pero existen varias versiones de este m√©todo (sobrecargado).



### **Sobrecarga de `fromJson()`**

Existen varias versiones sobrecargadas de `fromJson()` que permiten analizar JSON desde diferentes fuentes como `String`, `Reader`, o `JsonReader`, `JsonElement`(Estas dos √∫ltimas procedentes del API de Gson).

```java
public <T> T fromJson (String json, Class<T> classOfT) 
    throws JsonSyntaxException;

public <T> T fromJson (String json, Type typeOfT)
    throws JsonSyntaxException;

public <T> T fromJson (String json, TypeToken<T> typeOfT)
    throws JsonSyntaxException;

public <T> T fromJson (Reader json, Class<T> classOfT)
    throws JsonSyntaxException, JsonIOException

public <T> T fromJson (Reader json, Type typeOfT)
    throws JsonIOException, JsonSyntaxException;

public <T> T fromJson (Reader json, TypeToken<T> typeOfT)
    throws JsonIOException, JsonSyntaxException;

public <T> T fromJson (JsonReader reader, Type typeOfT)
    throws JsonIOException, JsonSyntaxException;

public <T> T fromJson (JsonReader reader, TypeToken<T> typeOfT)
    throws JsonIOException, JsonSyntaxException;

public <T> T fromJson (JsonElement json, Class<T> classOfT)
    throws JsonSyntaxException;

public <T> T fromJson (JsonElement json, Type typeOfT)
    throws JsonSyntaxException;

public <T> T fromJson (JsonElement json, TypeToken<T> typeOfT)
    throws JsonSyntaxException;
```

---

# 3. **Exclusi√≥n de Atributos en la Serializaci√≥n**

Puedes **excluir ciertos atributos** de tus objetos Java durante la serializaci√≥n con Gson.

## 3.1. **Atributos `transient`**



>Los atributos marcados como `transient` **no se incluir√°n en la serializaci√≥n ni deserializaci√≥n.**


```java
public class Poeta {
    public transient String nome;  // No se serializa
    public int idade;
}
```

## 3.2. **Anotaci√≥n `@Expose`**

- Para mayor control, puedes usar la anotaci√≥n `@Expose` y configurar `GsonBuilder` para que **excluya los campos sin esta anotaci√≥n**.



>‚ùóLa anotaci√≥n `expose` solo funcionara si se crea un objeto de tipo `GsonBuilder`



- La anotaci√≥n `@Expose` **puede tener dos par√°metros: `serialize` y `deserialize`**, ambos son **booleanos** que pueden tener los valores `true` o `false`:
    - El par√°metro `serialize` de la anotaci√≥n `@Expose` indica si el atributo anotado con la `@Expose` debe incluirse cuando el objeto se serializa.
    - El par√°metro `deserialize` anota si ese atributo debe leerse cuando el objeto se deserializa.

```java
public class Estudiante {
   @Expose private String nome; // Se incluir√° en la serializaci√≥n y deserializaci√≥n
   @Expose(serialize = false) private String apelidos;//no serializa
   @Expose (serialize = false, deserialize = false) private String email; // ni serializa ni deserializa
   private String password; // ... ? NO LO SERIALIZA NI DESERIALIZA (sin anotacion @expose)
 }
```

- Formatos anotaci√≥n @Expose:
    - `@Expose(serialize = true);`
    - `@Expose(serialize = false);`
    - `@Expose(deserialize = true);`
    - `@Expose(deserialize = false);`
    - `@Expose(serialize = true, deserialize = false);`
    - `@Expose(serialize = false, deserialize = true);`

```java
Gson gson = new GsonBuilder().excludeFieldsWithoutExposeAnnotation().create();
```

## 3.3. Exclusi√≥n con `ExclusionStrategy`

Si necesitas m√°s control, puedes implementar la interfaz `ExclusionStrategy` para excluir campos de forma personalizada. Esta estrategia te **permite especificar qu√© campos o clases deben ser excluidos.**



>‚ùó[`ExclusionStrategy`](https://www.javadoc.io/static/com.google.code.gson/gson/2.10.1/com.google.gson/com/google/gson/ExclusionStrategy.html) es una interfaz, por lo que hay que **crear una clase que implemente la interfaz `ExclusionStrategy`**.



```java
ExclusionStrategy exclusion = new ExclusionStrategy() {
public boolean shouldSkipField(FieldAttributes field) {
return field.getName().equals("password");
}
public boolean shouldSkipClass(Class<?> clazz) {
return false;
}
};
Gson gson = new GsonBuilder().setExclusionStrategies(exclusion).create();
```

## 3.4. Serializaci√≥n de Campos Nulos

Por defecto, Gson excluye campos null. Para incluirlos:

```java
Gson gson = new GsonBuilder().serializeNulls().create();
```

- Ejemplo:

```json
{"nome": null, "idade": 30}
```

---

# Resumen de M√©todos Clave de Gson

- `toJson(Object src)`: Convierte un objeto Java a JSON.
- `fromJson(String json, Class<T> classOfT)`: Convierte JSON a un objeto Java.
- `GsonBuilder.setPrettyPrinting()`: Formato de salida legible.
- `GsonBuilder.excludeFieldsWithoutExposeAnnotation()`: Excluye atributos no marcados con `@Expose`.
- `GsonBuilder.serializeNulls()`: Incluye campos con valor `null` en la salida JSON.

üí°Con estos conceptos y ejemplos, puedes trabajar con JSON de manera eficiente en tus aplicaciones Java usando la biblioteca Gson.

